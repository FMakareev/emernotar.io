exports.id = "main";
exports.modules = {

/***/ "./src/server/newCreateEmailTemplate.js":
/*!**********************************************!*\
  !*** ./src/server/newCreateEmailTemplate.js ***!
  \**********************************************/
/*! exports provided: createEmailTemplate, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"createEmailTemplate\", function() { return createEmailTemplate; });\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/regenerator */ \"@babel/runtime/regenerator\");\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ \"@babel/runtime/helpers/asyncToGenerator\");\n/* harmony import */ var _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var react_apollo__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-apollo */ \"react-apollo\");\n/* harmony import */ var react_apollo__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react_apollo__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var juice__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! juice */ \"juice\");\n/* harmony import */ var juice__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(juice__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var url__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! url */ \"url\");\n/* harmony import */ var url__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(url__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var query_parse__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! query-parse */ \"query-parse\");\n/* harmony import */ var query_parse__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(query_parse__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var react_redux__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! react-redux */ \"react-redux\");\n/* harmony import */ var react_redux__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(react_redux__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var _store__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../store */ \"./src/store/index.js\");\n/* harmony import */ var _store_reducers_localization_actions__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../store/reducers/localization/actions */ \"./src/store/reducers/localization/actions.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_10__);\n/* harmony import */ var react_dom_server__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! react-dom/server */ \"react-dom/server\");\n/* harmony import */ var react_dom_server__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(react_dom_server__WEBPACK_IMPORTED_MODULE_11__);\n/* harmony import */ var react_fela__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! react-fela */ \"react-fela\");\n/* harmony import */ var react_fela__WEBPACK_IMPORTED_MODULE_12___default = /*#__PURE__*/__webpack_require__.n(react_fela__WEBPACK_IMPORTED_MODULE_12__);\n/* harmony import */ var fela_dom__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! fela-dom */ \"fela-dom\");\n/* harmony import */ var fela_dom__WEBPACK_IMPORTED_MODULE_13___default = /*#__PURE__*/__webpack_require__.n(fela_dom__WEBPACK_IMPORTED_MODULE_13__);\n/* harmony import */ var _apollo_index_server__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../apollo/index.server */ \"./src/apollo/index.server.js\");\n/* harmony import */ var _style_theme__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../style/theme */ \"./src/style/theme.js\");\n/* harmony import */ var _style__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../style */ \"./src/style/index.js\");\n/* harmony import */ var _html__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./html */ \"./src/server/html.js\");\n/* harmony import */ var _modules_static_view_mail_index__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../modules/static/view/mail/index */ \"./src/modules/static/view/mail/index.js\");\n/* harmony import */ var _modules_static_view_mailIOS_index__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../modules/static/view/mailIOS/index */ \"./src/modules/static/view/mailIOS/index.js\");\n/* harmony import */ var react_localize_redux_lib_index__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! react-localize-redux/lib/index */ \"react-localize-redux/lib/index\");\n/* harmony import */ var react_localize_redux_lib_index__WEBPACK_IMPORTED_MODULE_20___default = /*#__PURE__*/__webpack_require__.n(react_localize_redux_lib_index__WEBPACK_IMPORTED_MODULE_20__);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar getTemplatePath = function getTemplatePath(queryParams) {\n  console.log('getTemplatePath: queryParams.template', queryParams.template === '0');\n  console.log('getTemplatePath: queryParams.emerhash', queryParams.emerhash);\n  console.log('getTemplatePath: queryParams.language', queryParams.language);\n\n  if (queryParams.template === '0') {\n    return react__WEBPACK_IMPORTED_MODULE_10___default.a.createElement(_modules_static_view_mail_index__WEBPACK_IMPORTED_MODULE_18__[\"default\"], {\n      emerhash: queryParams.emerhash\n    });\n  } else if (queryParams.template === '1') {\n    return react__WEBPACK_IMPORTED_MODULE_10___default.a.createElement(_modules_static_view_mailIOS_index__WEBPACK_IMPORTED_MODULE_19__[\"default\"], {\n      url: queryParams.url\n    });\n  } else {\n    return null;\n  }\n};\n\nvar createEmailTemplate =\n/*#__PURE__*/\nfunction () {\n  var _ref = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()(\n  /*#__PURE__*/\n  _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee(request, response) {\n    var params, _url$parse, search, queryParams, language, renderer, Component;\n\n    return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            params = request.params;\n            _url$parse = url__WEBPACK_IMPORTED_MODULE_5___default.a.parse(request.originalUrl), search = _url$parse.search;\n            queryParams = search ? query_parse__WEBPACK_IMPORTED_MODULE_6___default.a.toObject(search.substring(1)) : {};\n            language = queryParams.language || 'EN';\n            console.log('createEmailTemplate: template', queryParams);\n            console.log('createEmailTemplate: search', search);\n            renderer = Object(_style__WEBPACK_IMPORTED_MODULE_16__[\"createStyleRenderer\"])();\n            _context.next = 10;\n            return _store__WEBPACK_IMPORTED_MODULE_8__[\"Store\"].dispatch(Object(_store_reducers_localization_actions__WEBPACK_IMPORTED_MODULE_9__[\"initLocalize\"])(_store__WEBPACK_IMPORTED_MODULE_8__[\"Store\"].getState(), language || 'EN'));\n\n          case 10:\n            // home_static_mail_subject\n            Component = react__WEBPACK_IMPORTED_MODULE_10___default.a.createElement(react_redux__WEBPACK_IMPORTED_MODULE_7__[\"Provider\"], {\n              store: _store__WEBPACK_IMPORTED_MODULE_8__[\"Store\"]\n            }, react__WEBPACK_IMPORTED_MODULE_10___default.a.createElement(react_fela__WEBPACK_IMPORTED_MODULE_12__[\"Provider\"], {\n              renderer: renderer\n            }, react__WEBPACK_IMPORTED_MODULE_10___default.a.createElement(react_fela__WEBPACK_IMPORTED_MODULE_12__[\"ThemeProvider\"], {\n              theme: Object(_style_theme__WEBPACK_IMPORTED_MODULE_15__[\"createTheme\"])(_style_theme__WEBPACK_IMPORTED_MODULE_15__[\"palette\"])\n            }, react__WEBPACK_IMPORTED_MODULE_10___default.a.createElement(react_apollo__WEBPACK_IMPORTED_MODULE_2__[\"ApolloProvider\"], {\n              client: _apollo_index_server__WEBPACK_IMPORTED_MODULE_14__[\"client\"]\n            }, params && params.emerhash ? react__WEBPACK_IMPORTED_MODULE_10___default.a.createElement(_modules_static_view_mail_index__WEBPACK_IMPORTED_MODULE_18__[\"default\"], {\n              emerhash: params.emerhash\n            }) : getTemplatePath(queryParams)))));\n            /**\r\n             * @param {Object} COMPONENT - React component\r\n             * @description https://www.apollographql.com/docs/react/features/server-side-rendering.html#renderToStringWithData\r\n             * */\n\n            _context.next = 13;\n            return Object(react_apollo__WEBPACK_IMPORTED_MODULE_2__[\"renderToStringWithData\"])(Component).then(function (content) {\n              var styleMarkup = Object(fela_dom__WEBPACK_IMPORTED_MODULE_13__[\"renderToMarkup\"])(renderer);\n              var REACT_HTML = react__WEBPACK_IMPORTED_MODULE_10___default.a.createElement(_html__WEBPACK_IMPORTED_MODULE_17__[\"default\"], {\n                subject: true,\n                language: language,\n                getStatic: true,\n                content: content\n              });\n              var HTML = \"<!doctype html>\\n\".concat(react_dom_server__WEBPACK_IMPORTED_MODULE_11___default.a.renderToStaticMarkup(REACT_HTML)).replace('<style></style>', styleMarkup); // fs.appendFile(`public/EmailTemplateInlineTEST.html`, juice(HTML, {\n              // \tinsertPreservedExtraCss: true,\n              // \tpreserveMediaQueries: true,\n              // \tremoveStyleTags: false,\n              // }), function (err) {\n              // \tif (err) throw err;\n              // \tconsole.log('Saved!');\n              // });\n\n              response.status(200);\n              /** @description http://expressjs.com/en/4x/api.html#res.send */\n\n              response.send(juice__WEBPACK_IMPORTED_MODULE_3___default()(HTML, {\n                insertPreservedExtraCss: true,\n                preserveMediaQueries: true,\n                removeStyleTags: false\n              }).replace('<mailsubject style=\"box-sizing: border-box;\">', \"<mailsubject>\"));\n              /** @description http://expressjs.com/en/4x/api.html#res.end */\n\n              response.end();\n            }).catch(function (error) {\n              console.log('error: ', error); // response.status(502);\n\n              response.send(JSON.stringify(error));\n              response.end();\n            });\n\n          case 13:\n            _context.next = 20;\n            break;\n\n          case 15:\n            _context.prev = 15;\n            _context.t0 = _context[\"catch\"](0);\n            console.log('error: ', _context.t0); // response.status(502);\n\n            response.send(JSON.stringify(_context.t0));\n            response.end();\n\n          case 20:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, this, [[0, 15]]);\n  }));\n\n  return function createEmailTemplate(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();\n/* harmony default export */ __webpack_exports__[\"default\"] = (createEmailTemplate());\n\n//# sourceURL=webpack:///./src/server/newCreateEmailTemplate.js?");

/***/ })

};